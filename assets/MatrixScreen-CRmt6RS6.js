import{j as e,l as D,a as z,n as w,F as k,h as g,o as j,i as S,p as M}from"./ui-ojUPcdkR.js";import{r as u}from"./vendor-S3JaNCHW.js";import{u as _}from"./useQuery-DrWLbDdI.js";import{g as E,c as x,a as C}from"./index-b6SL6hsZ.js";import{S as J}from"./Select-0tL3yPF9.js";const $=new Date().getMonth()+1,h=new Date().getFullYear(),q=(a,f,m)=>{const d=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"][f-1];return a===1?`1-7 ${d}`:a===2?`8-14 ${d}`:a===3?`15-21 ${d}`:a===4?`22-28 ${d}`:`29-End ${d}`};function W(){const[a,f]=u.useState($.toString()),[m,N]=u.useState(""),[d,v]=u.useState("all"),i=E(h,parseInt(a)-1),F=10*1e3,{data:n,isLoading:I}=_({queryKey:["students",a,h],queryFn:()=>C.getStudents(parseInt(a),h),staleTime:5*1e3,refetchInterval:F}),{data:s}=_({queryKey:["settings",a,h],queryFn:()=>C.getSettings(parseInt(a),h),staleTime:30*1e3,refetchInterval:30*1e3}),T=n&&n.length>0&&n.some(r=>(r.m1||0)+(r.m2||0)+(r.m3||0)+(r.m4||0)+(r.m5||0)>0),A=s&&s.weeklyFee>0||T,L=r=>s?r>=s.weeklyFee?"paid":r>0?"partial":"unpaid":"pending",b=u.useMemo(()=>n?n.filter(r=>{const t=(r.name||"").toLowerCase().includes(m.toLowerCase())||r.nim.includes(m);if(d==="all"||!s)return t;const l=s.weeklyFee,o=r.m1<l||r.m2<l||r.m3<l||r.m4<l||i===5&&r.m5<l;return t&&o}):[],[n,m,d,s,i]),p=u.useMemo(()=>{if(!n||!s)return{total:0,fullyPaid:0,hasArrears:0};const r=s.weeklyFee;let t=0,l=0;return n.forEach(o=>{o.m1>=r&&o.m2>=r&&o.m3>=r&&o.m4>=r&&(i<5||o.m5>=r)?t++:l++}),{total:n.length,fullyPaid:t,hasArrears:l}},[n,s,i]),c=(r,t)=>{if(!s)return e.jsx("span",{className:"text-slate-300",children:"-"});if(t===5&&i<5)return e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-200 mx-auto"});const l=L(r);return l==="paid"?e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-100 dark:bg-emerald-900/20 flex items-center justify-center text-emerald-600 dark:text-emerald-400 transition-all hover:scale-110 cursor-pointer",children:e.jsx(g,{className:"w-3.5 h-3.5"})})}):l==="partial"?e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-amber-100 dark:bg-amber-900/20 flex items-center justify-center text-amber-600 dark:text-amber-400 transition-all hover:scale-110 cursor-pointer",title:"Dicicil (Belum Lunas)",children:e.jsx(S,{className:"w-3.5 h-3.5"})})}):e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-6 h-6 rounded-full bg-muted flex items-center justify-center text-muted-foreground transition-all hover:bg-muted/80 hover:text-foreground cursor-pointer",children:e.jsx(M,{className:"w-4 h-4"})})})},y=[{label:"Januari",value:"1"},{label:"Februari",value:"2"},{label:"Maret",value:"3"},{label:"April",value:"4"},{label:"Mei",value:"5"},{label:"Juni",value:"6"},{label:"Juli",value:"7"},{label:"Agustus",value:"8"},{label:"September",value:"9"},{label:"Oktober",value:"10"},{label:"November",value:"11"},{label:"Desember",value:"12"}],P=y[parseInt(a)-1]?.label||"Unknown";return e.jsx("div",{className:"p-4 md:p-8 bg-background min-h-screen animate-fadeIn pb-32 font-sans",children:e.jsx("div",{className:"max-w-6xl mx-auto space-y-8",children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6",children:[e.jsxs("div",{className:"pb-2",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-foreground tracking-tight",children:"Matriks Iuran"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1 text-sm md:text-base max-w-md font-medium",children:"Monitor status pembayaran anggota secara real-time."})]}),e.jsxs("div",{className:"bg-card p-2 rounded-2xl shadow-sm border border-border flex items-center gap-3 w-full lg:w-auto self-start lg:self-auto",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-50 dark:bg-indigo-900/20 flex items-center justify-center text-indigo-600 dark:text-indigo-400 shrink-0",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("div",{className:"grid grid-cols-1 gap-2 flex-1 md:min-w-[180px]",children:e.jsx(J,{label:"",value:a,onChange:r=>f(r.target.value),options:y})})]})]}),I?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-primary"})}):A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"group relative p-6 rounded-[2rem] bg-card border border-border shadow-[0_8px_30px_rgb(0,0,0,0.04)] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-2xl flex items-center justify-center",children:e.jsx(k,{className:"w-6 h-6 stroke-[2px]"})}),e.jsx("span",{className:"text-xs font-bold px-2.5 py-1.5 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-full",children:"Total"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-muted-foreground text-xs font-bold uppercase tracking-wider mb-2",children:"Total Anggota"}),e.jsx("h3",{className:"text-2xl font-extrabold text-foreground",children:p.total})]}),e.jsx("div",{className:"absolute -right-6 -bottom-6 w-24 h-24 bg-blue-500 rounded-full opacity-5 blur-2xl transition-opacity group-hover:opacity-10"})]}),e.jsxs("div",{className:"group relative p-6 rounded-[2rem] bg-card border border-border shadow-[0_8px_30px_rgb(0,0,0,0.04)] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 rounded-2xl flex items-center justify-center",children:e.jsx(g,{className:"w-6 h-6 stroke-[2px]"})}),e.jsx("span",{className:"text-xs font-bold px-2.5 py-1.5 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-full",children:"Lunas"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-muted-foreground text-xs font-bold uppercase tracking-wider mb-2",children:"Lunas Semua"}),e.jsx("h3",{className:"text-2xl font-extrabold text-emerald-600 dark:text-emerald-400",children:p.fullyPaid})]}),e.jsx("div",{className:"absolute -right-6 -bottom-6 w-24 h-24 bg-emerald-500 rounded-full opacity-5 blur-2xl transition-opacity group-hover:opacity-10"})]}),e.jsxs("div",{className:"group relative p-6 rounded-[2rem] bg-card border border-border shadow-[0_8px_30px_rgb(0,0,0,0.04)] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-50 dark:bg-rose-900/20 text-rose-600 dark:text-rose-400 rounded-2xl flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6 stroke-[2px]"})}),e.jsx("span",{className:"text-xs font-bold px-2.5 py-1.5 bg-rose-50 dark:bg-rose-900/30 text-rose-600 dark:text-rose-400 rounded-full",children:"Tunggakan"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-muted-foreground text-xs font-bold uppercase tracking-wider mb-2",children:"Ada Tunggakan"}),e.jsx("h3",{className:"text-2xl font-extrabold text-rose-600 dark:text-rose-400",children:p.hasArrears})]}),e.jsx("div",{className:"absolute -right-6 -bottom-6 w-24 h-24 bg-rose-500 rounded-full opacity-5 blur-2xl transition-opacity group-hover:opacity-10"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(j,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Cari nama atau NIM mahasiswa...",value:m,onChange:r=>N(r.target.value),className:"w-full pl-12 pr-4 py-3 bg-card border border-border rounded-xl focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all font-medium text-foreground placeholder:text-muted-foreground"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v("all"),className:x("px-4 py-2 rounded-xl text-xs font-bold transition-all border",d==="all"?"bg-foreground text-background border-foreground":"bg-card text-muted-foreground border-border hover:bg-muted"),children:"Semua"}),e.jsxs("button",{onClick:()=>v("unpaid"),className:x("px-4 py-2 rounded-xl text-xs font-bold transition-all border flex items-center gap-2",d==="unpaid"?"bg-destructive text-destructive-foreground border-destructive":"bg-card text-destructive border-destructive/20 hover:bg-destructive/10"),children:[e.jsx(k,{className:"w-3 h-3"}),"Tunggakan"]})]})]}),e.jsx("div",{className:"hidden md:block bg-card rounded-[1.5rem] border border-border overflow-hidden shadow-sm relative z-0",children:e.jsx("div",{className:"overflow-x-auto custom-scrollbar max-h-[600px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse relative",children:[e.jsx("thead",{className:"sticky top-0 z-30",children:e.jsxs("tr",{className:"bg-muted/95 backdrop-blur-sm border-b border-border shadow-[0_2px_10px_rgba(0,0,0,0.02)]",children:[e.jsx("th",{className:"p-5 text-[10px] font-black uppercase text-muted-foreground sticky left-0 bg-muted z-30 min-w-[180px] shadow-[4px_0_24px_-12px_rgba(0,0,0,0.1)]",children:"Mahasiswa"}),[1,2,3,4,5].map(r=>e.jsx("th",{className:x("p-4 text-center min-w-[80px] group relative",r===5&&i<5&&"opacity-30"),children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase text-muted-foreground",children:["M",r]}),e.jsx("span",{className:"hidden lg:inline-block text-[9px] font-medium text-muted-foreground mt-0.5 whitespace-nowrap bg-background/50 px-1.5 py-0.5 rounded",children:q(r,parseInt(a))})]})},r))]})}),e.jsx("tbody",{className:"text-xs font-bold",children:b.length>0?b.map((r,t)=>e.jsxs("tr",{className:x("border-b border-border last:border-0 transition-colors group",t%2===0?"bg-card":"bg-muted/30","hover:!bg-primary/5"),children:[e.jsx("td",{className:x("p-4 text-foreground sticky left-0 z-20 border-r border-border shadow-[4px_0_24px_-12px_rgba(0,0,0,0.05)] transition-colors","bg-card group-hover:bg-card"),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"truncate font-bold text-foreground",children:r.name}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-medium group-hover:text-primary transition-colors",children:r.nim})]})}),e.jsx("td",{className:"p-4 text-center",children:c(r.m1,1)}),e.jsx("td",{className:"p-4 text-center",children:c(r.m2,2)}),e.jsx("td",{className:"p-4 text-center",children:c(r.m3,3)}),e.jsx("td",{className:"p-4 text-center",children:c(r.m4,4)}),e.jsx("td",{className:x("p-4 text-center",i<5&&"opacity-30"),children:c(r.m5,5)})]},r.nim)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-12 text-center text-muted-foreground",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx(j,{className:"w-8 h-8 opacity-20"}),e.jsx("p",{className:"text-sm font-medium",children:"Tidak ada data mahasiswa ditemukan"})]})})})})]})})}),e.jsx("div",{className:"md:hidden space-y-4",children:b.length>0?b.map(r=>e.jsxs("div",{className:"bg-card p-4 rounded-3xl border border-border shadow-sm flex flex-col gap-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-foreground",children:r.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.nim})]})}),e.jsx("div",{className:"flex justify-between items-center gap-2 p-3 bg-muted/30 rounded-2xl",children:[1,2,3,4,5].map(t=>t===5&&i<5?null:e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-1",children:[e.jsxs("span",{className:"text-[9px] font-bold text-muted-foreground uppercase",children:["M",t]}),e.jsx("div",{className:"scale-90 transform-origin-center",children:c(r[`m${t}`],t)})]},t))})]},r.nim)):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center space-y-4 bg-muted/30 rounded-[2rem]",children:[e.jsx("div",{className:"w-16 h-16 bg-card rounded-full flex items-center justify-center shadow-sm",children:e.jsx(j,{className:"w-6 h-6 text-muted-foreground/50"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-foreground",children:"Tidak Ditemukan"}),e.jsx("p",{className:"text-muted-foreground text-sm max-w-[200px] mx-auto",children:"Tidak ada data mahasiswa yang cocok dengan pencarian."})]})]})}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 mt-4 opacity-70",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-emerald-100 dark:bg-emerald-900/40 flex items-center justify-center text-emerald-600 dark:text-emerald-400",children:e.jsx(g,{className:"w-2.5 h-2.5"})}),e.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase",children:"Lunas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-amber-100 dark:bg-amber-900/20 flex items-center justify-center text-amber-600 dark:text-amber-400",children:e.jsx(S,{className:"w-2.5 h-2.5"})}),e.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase",children:"Dicicil"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400 dark:text-slate-500",children:e.jsx(M,{className:"w-2.5 h-2.5"})}),e.jsx("span",{className:"text-[10px] font-bold text-muted-foreground uppercase",children:"Belum Bayar"})]})]})]}):e.jsxs("div",{className:"bg-card rounded-[2rem] border border-dashed border-border p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-amber-50 dark:bg-amber-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(w,{className:"w-10 h-10 text-amber-400"})}),e.jsx("h3",{className:"text-xl font-bold text-foreground mb-2",children:"Data Belum Tersedia"}),e.jsxs("p",{className:"text-muted-foreground max-w-md mx-auto mb-6",children:["Periode ",e.jsx("span",{className:"font-semibold text-foreground",children:P})," belum memiliki data iuran. Silakan konfigurasikan kas di menu Settings."]})]})]})})})}export{W as MatrixScreen};
